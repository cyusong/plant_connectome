Obligate mutualisms require filtering mechanisms to prevent their exploitation by opportunists, but ecological contexts and traits facilitating the evolution of such mechanisms are largely unknown. We investigated the evolution of filtering mechanisms in an epiphytic ant-plant symbiotic system in Fiji involving Rubiaceae and dolichoderine ants, using field experiments, metabolomics, X-ray micro-computed tomography (micro-CT) scanning and phylogenetics. We discovered a novel plant reward consisting of sugary sap concealed in post-anthetic flowers only accessible to Philidris nagasau workers that bite through the thick epidermis. In five of the six species of Rubiaceae obligately inhabited by this ant, the nectar glands functioned for 10 d after a flower's sexual function was over. Sugar metabolomics and field experiments showed that ant foraging tracks sucrose levels, which only drop at the onset of fruit development. Ontogenetic analyses of our focal species and their relatives revealed a 25-fold increase in nectary size and delayed fruit development in the ant-rewarding species, and Bayesian analyses of several traits showed the correlated evolution of sugar rewards and symbiosis specialization. Concealed floral nectar forestalls exploitation by opportunists (generalist ants) and stabilizes these obligate mutualisms. Our study pinpoints the importance of partner choice mechanisms in transitions from facultative to obligate mutualisms.

Rubiaceae: !rewards! Philidris nagasau workers 
Philidris nagasau workers: !bite through! thick epidermis 
Rubiaceae: !function for! 10 days 
Sugar metabolomics: !track! sucrose levels 
Ontogenetic analyses: !reveal! 25-fold increase in nectary size 
Bayesian analyses: !show! correlated evolution of sugar rewards and symbiosis specialization 
Concealed floral nectar: !forestalls exploitation by! opportunists