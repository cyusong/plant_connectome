The accurate detection and segmentation of apples during growth stage is essential for yield estimation, timely harvesting, and retrieving growth information. However, factors such as the uncertain illumination, overlaps and occlusions of apples, homochromatic background and the gradual change in the ground color of apples from green to red, bring great challenges to the detection and segmentation of apples. To solve these problems, this study proposed an improved Mask Scoring region-based convolutional neural network (Mask Scoring R-CNN), known as MS-ADS, for accurate apple detection and instance segmentation in a natural environment. First, the ResNeSt, a variant of ResNet, combined with a feature pyramid network was used as backbone network to improve the feature extraction ability. Second, high-level architectures including R-CNN head and mask head were modified to improve the utilization of high-level features. Convolutional layers were added to the original R-CNN head to improve the accuracy of bounding box detection (<i>bbox_mAP</i>), and the Dual Attention Network was added to the original mask head to improve the accuracy of instance segmentation (<i>mask_mAP</i>). The experimental results showed that the proposed MS-ADS model effectively detected and segmented apples under various conditions, such as apples occluded by branches, leaves and other apples, apples with different ground colors and shadows, and apples divided into parts by branches and petioles. The <i>recall</i>, <i>precision</i>, false detection rate, and <i>F</i>1 score were 97.4%, 96.5%, 3.5%, and 96.9%, respectively. A <i>bbox_mAP</i> and <i>mask_mAP</i> of 0.932 and 0.920, respectively, were achieved on the test set, and the average run-time was 0.27 s per image. The experimental results indicated that the MS-ADS method detected and segmented apples in the orchard robustly and accurately with real-time performance. This study lays a foundation for follow-up work, such as yield estimation, harvesting, and automatic and long-term acquisition of apple growth information.

ResNeSt: !combined with! Feature Pyramid Network 
R-CNN Head: !modified to improve! Utilization of High-Level Features 
Mask Head: !modified to improve! Accuracy of Instance Segmentation 
Dual Attention Network: !added to! Mask Head 
MS-ADS Model: !effectively detected and segmented! Apples 
MS-ADS Model: !achieved! bbox_mAP and mask_mAP of 0.932 and 0.920 
MS-ADS Model: !had an average run-time of! 0.27 s per image